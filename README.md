# eat_what · AstrBot 插件

一个根据关键词自动推荐「吃什么 / 喝什么」的 AstrBot 插件。  
支持关键词触发、随机推荐、食物素材管理，并自动处理图片格式。

---

## ✨ 功能特性

- 自动识别关键词并回复推荐内容
- 支持 *食物 (food)* 与 *饮料 (drink)* 分类
- LLM 工具调用（eat_what / drink_what），更精准识别用户意图
- 图片自动保存为 JPG（含透明转白底、自动缩放）
- 支持添加 / 删除条目
- 自动从消息或引用消息中提取图片
- 数据持久化，重启不丢失

---

## 🧠 LLM 支持（Tool Calling）

本插件内置两个 LLM Tool，可供 LLM 直接调用：

### **1. eat_what 工具**

用于处理 **吃什么** 的推荐场景。

LLM 会在用户表达以下意图时调用：

- 明确询问吃什么
- 请求推荐食物
- 表达不知道吃什么
- 用反问催促机器人推荐

示例触发语句：

```
吃什么？
吃点啥？
推荐点吃的
不知道吃什么，你帮我选
怎么不推荐点吃的？
```

不会触发的语句：

```
不吃了
不想吃东西
先不吃
```

---

### **2. drink_what 工具**

用于处理 **喝什么** 的推荐场景。

LLM 会在用户表达以下意图时调用：

- 明确询问喝什么
- 请求推荐饮料
- 表达口渴或不知道喝什么
- 用反问形式催促机器人推荐

示例触发语句：

```
喝什么？
喝点啥？
推荐一个饮料
不知道喝点什么
不推荐点喝的？
```

不会触发的语句：

```
不喝
不想喝东西
先不喝了
```

---

## 📌 指令说明

### 添加条目（管理员）

```
eat_what add <food|drink> <名称>
```

> 必须附带 1 张图片（消息本身或引用消息均可）

示例：

```
eat_what add food 拉面
eat_what add drink 奶茶
```

---

### 删除条目（管理员）

```
eat_what del <food|drink> <名称>
```

示例：

```
eat_what del drink 奶茶
```

---

### 查看列表

```
eat_what list <food|drink>
```

示例：

```
eat_what list food
eat_what list drink
```

---

## 🤖 自动推荐触发

当用户消息中包含配置中的关键词时：

- 命中「吃」相关关键词 → 从 `food` 中随机推荐
- 命中「喝」相关关键词 → 从 `drink` 中随机推荐

机器人会发送：

- 一张食物 / 饮料图片
- 一条文本：`推荐你吃/喝 <名称>`

---

## ⚙ 配置说明

在插件配置中填写：

- `eat_keywords`：触发吃东西推荐的关键词列表
- `drink_keywords`：触发喝东西推荐的关键词列表

示例（JSON）：

```json
{
  "eat_keywords": [
    "吃什么",
    "午饭吃啥",
    "晚饭吃啥"
  ],
  "drink_keywords": [
    "喝什么",
    "奶茶推荐",
    "想喝点东西"
  ]
}
```

---

## 📁 数据与资源目录

插件会在 AstrBot 数据目录中创建自己的资源目录，例如：

```
astrbot_data/
  data/
    plugin_data/
      astrbot_plugin_eat_what/
        foods/*.jpg
        drinks/*.jpg
```

- 新增条目时会自动保存图片到对应目录
- `datastore.json` 用于记录现有食物 / 饮料名称列表

---

## 🧩 依赖

本插件通过 `requirements.txt` 自动安装依赖：

- `Pillow`：用于图片处理（格式转换、缩放、去透明）

AstrBot 会自动根据 `requirements.txt` 安装所需依赖，无需手动操作。

---

## 📚 帮助文档

更多关于 AstrBot 的使用方法，可以参阅：

[帮助文档](https://astrbot.app)
